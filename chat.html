<!DOCTYPE html><title>Chat</title><style>:root{--textColor:#FFF;--flareColor1:#00003B;--flareColor2:#E10600;--darkColor:#111;--lightColor:#222;--vipColor:#00FF41;--adminColor:#0041FF;--modColor:#0041FF;--ownerColor:#A00}body{background-color:var(--darkColor);margin:0;padding:0;border:0;font-family:Courier New}.header{background-color:var(--lightColor);color:var(--textColor);font-size:38px;width:100%;text-align:center;position:fixed;top:0;left:0}#messages{margin-right:150px;margin-bottom:10px;margin-left:150px;margin-top:0}#usernames{background-color:var(--lightColor);height:100vh;width:100px;overflow-y:scroll;padding:10px;padding-bottom:100px;position:fixed;top:0;right:0}.message{margin:10px;width:100%;text-align:center;color:var(--textColor);word-break:break-word;padding:5px;font-size:20px;display:block}.out{text-align:right}.in{text-align:left}#sendMessageDiv{font-family:Courier New;font-size:50px;width:100%;text-align:center;background-color:var(--lightColor);color:var(--textColor);position:fixed;bottom:0;left:0}.button{background-color:var(--flareColor1);color:#fff;border-radius:10px;padding:10px;margin:1%;text-align:center;width:13%;border:none;height:50px;font-size:20px;font-family:Courier New}.inputs{background-color:var(--darkColor);font-family:Courier New;color:#fff;font-size:20px}.hidden{display:none}#modal{width:50%;height:50%;background-color:var(--lightColor);border-radius:10px;margin:0;padding:0;border:0;text-align:center;position:fixed;translate:50% 50%}#loginButton{width:40%!important}#loginDiv{margin:20px}#loginTitle{color:var(--textColor);font-size:38px}#loginMessage{color:var(--lightColor);font-size:18px}.user{width:70px;min-height:100px;background-color:var(--darkColor);font-size:15px;margin:5px;border-radius:10px;text-align:center;color:var(--textColor);word-break:break-word;border:none;font-family:Courier New;padding:5px}.pinnedServer{width:70px;min-height:100px;background-color:var(--darkColor);font-size:15px;margin:5px;border-radius:10px;text-align:center;color:var(--textColor);word-break:break-word;border:none;font-family:Courier New;padding:5px}.MD{font-size:13px}.vip{color:var(--vipColor)!important}.admin{color:var(--adminColor)!important}.mod{color:var(--modColor)!important}.owner{color:var(--ownerColor)!important}.pfp{margin:5px;margin-bottom:-23px}#pinnedServers{background-color:var(--lightColor);height:100vh;width:100px;overflow-y:scroll;padding:10px;position:fixed;top:0;left:0}</style><div id=chat class=hidden><div class=header><span id=pinnedServerName></span>:</div><div id=messages></div><div id=sendMessageDiv><input class=inputs id=message placeholder="Send A Message!"required><button class=button onclick=sendMessage()><strong>Send!</strong></button></div><div id=pinnedServers></div><div id=usernames></div></div><div id=login><div id=modal><br><strong id=loginTitle>Log In</strong><br><strong id=loginMessage>{{loginmessage}}</strong><br><div id=loginDiv><input class=inputs id=username placeholder=Username required><br><input class=inputs id=password placeholder=Password required type=password><br><button class=button onclick=login() id=loginButton><strong>Go!</strong></button></div></div></div><script src=https://www.gstatic.com/firebasejs/8.10.1/firebase.js></script><script>var encodeUnicode=e=>e.replace(/[\u00A0-\u9999<>\&]/g,e=>"&#"+e.charCodeAt(0)+";"),firebaseConfig={apiKey:"AIzaSyCgBnFbvZOW4dt-Fj64p_RS9_D59SZXEjY",authDomain:"advanced-firebase-chat.firebaseapp.com",databaseURL:"https://advanced-firebase-chat-default-rtdb.firebaseio.com",projectId:"advanced-firebase-chat",storageBucket:"advanced-firebase-chat.appspot.com",messagingSenderId:"108103744265",appId:"1:108103744265:web:568abc82110afa4a7c71d8",measurementId:"G-7RWXW0W1KM"};firebase.initializeApp(firebaseConfig);var server="main",username="",password="",ranks={user:{text:"User"},vip:{text:"VIP"},mod:{text:"Mod"},admin:{text:"Admin"},owner:{text:"Owner"}},myDatabase={},chatLoop=null;function sendMessage(){var e=getInput("message").value;saveMessage(username,e),getInput("message").value=""}function getInput(e){return document.querySelector("#"+e)}async function userExists(e){var r=!1;return await firebase.database().ref().child("users").once("value").then(a=>{for(var s in a.val())e==s&&(r=!0)}),r}async function login(){username=getInput("username").value,password="",userExists(username)&&await firebase.database().ref().child("users").child(username).once("value").then(e=>{password=e.val().password}),password==getInput("password").value?(document.querySelector("#loginMessage").innerHTML="Loging In...",document.querySelector("#loginMessage").style.color="white",checkMyDatabase(),chatLoop=setInterval(checkMyDatabase,4),document.querySelector("#login").classList.add("hidden"),document.querySelector("#chat").classList.remove("hidden"),document.querySelector("#chat").style.display="grid"):(document.querySelector("#loginMessage").innerHTML="Username Or Password Incorrect!",document.querySelector("#loginMessage").style.color="red")}function getTimeAndDate(){var e=new Date,r=e.getHours(),a=e.getMinutes();return"on "+(e.getMonth()+1)+"/"+e.getDate()+"/"+e.getFullYear().toString().replace("20","")+" at "+(r>12?r-12+":"+a+" PM":r+":"+a+" AM")}async function joinServer(e){await firebase.database().ref().child("users").child(username).once("value").then(e=>{e.val().rank?e.val().rank:"user"});var r=!1;await firebase.database().ref().child("servers").child(e).child("users").once("value").then(e=>{for(var a in e.val())a==username&&(r=!0)}),r&&(server=e),updateChat(myDatabase)}function addPinnedServers(e){var r=document.createElement("div");for(var a in e)for(var s in e[a].users)if(s==username){var n=document.createElement("button");n.innerHTML='<img src="'+e[a].PFPURL+'" style="width: 50px; height: 50px; border-radius: 50%; border: 3px solid #000;" alt="Server "'+a+'"\'s PFP"><br />'+encodeUnicode(a),n.classList.add("pinnedServer"),n.setAttribute("onclick","joinServer('"+a+"')"),a==server&&(n.style.boxShadow="0 0 10px 0px var(--flareColor2)"),r.appendChild(n)}document.querySelector("#pinnedServers").innerHTML=r.innerHTML,document.querySelector("#pinnedServerName").innerText=server}async function addServerUsers(e){var r=document.createElement("div");for(var a in e)await firebase.database().ref().child("users").child(a).once("value").then(e=>{if(e.exists()){var s=e.val();(null==s.PFPURL||""==s.PFPURL)&&(s.PFPURL="https://i.ibb.co/QjwbhJR/AC226-DA1-9-AB7-4-C04-A31-A-EBDD28-A9-FCFB.webp");var n=document.createElement("div");n.classList.add("user"),n.innerHTML='<img class="pfp" src="'+s.PFPURL+'" style="width: 50px; height: 50px; border-radius: 50%; border: 3px solid #000;" alt="'+s.username+"'s PFP\"><br /><br />"+("user"==s.rank||"vip"==s.rank||"mod"==s.rank||"admin"==s.rank||"owner"==s.rank?'<strong class="'+s.rank+'">['+ranks[s.rank].text+"]</strong><br />":"<strong>[User]</strong><br />")+a+"<br /><br />",r.appendChild(n)}});document.querySelector("#usernames").innerHTML=r.innerHTML}function help(e){joinServer("help-"+e),firebase.database().ref().child("servers").child("help-"+e).child("users").child("Bennett").set("")}function inviteAll(){firebase.database().ref().child("users").once("value").then(e=>{for(var r in e.val())firebase.database().ref().child("servers").child(server).child("users").child(r).set("")})}function renderMessage(e,r){var a=document.createElement("div");return(null==e.PFPURL||""==e.PFPURL)&&(e.PFPURL="https://i.ibb.co/QjwbhJR/AC226-DA1-9-AB7-4-C04-A31-A-EBDD28-A9-FCFB.webp"),a.innerHTML=(r?'<img class="pfp" src="'+e.PFPURL+'" style="width: 50px; height: 50px; border-radius: 50%; border: 3px solid #000;" alt="'+e.username+"'s PFP\">":null)+("user"==e.rank||"vip"==e.rank||"mod"==e.rank||"admin"==e.rank||"owner"==e.rank?'<strong class="'+e.rank+'">['+ranks[e.rank].text+"]</strong> ":"<strong>[User]</strong> "),a.innerHTML+=e.html?(e.username==username?"You":e.username)+":<br />"+e.message:(e.username==username?"You":e.username)+":<br />"+encodeUnicode(e.message),a.innerHTML+='<br><span class="MD">'+e.time+"</span>","/all/"==server&&(a.innerHTML+='<br><span class="MD">'+e.server+"</span>"),a.classList.add("message"),a.style=e.css,a.classList.add(e.username==username?"out":"in"),(e.server==server||"/all/"==server)&&a}async function saveMessage(e,r){var a=firebase.database().ref().child("servers").child(server).child("messages"),s="";await firebase.database().ref().child("users").child(username).once("value").then(e=>{s=e.val().messageCSS?e.val().messageCSS:""});var n="";await firebase.database().ref().child("users").child(username).once("value").then(e=>{n=e.val().rank?e.val().rank:"user"});var t="";if(await firebase.database().ref().child("users").child(username).once("value").then(e=>{t=e.val().PFPURL?e.val().PFPURL:""}),0==r.indexOf("/link "))a.push().set({username:e,message:'<a href="'+r.replace("/link ","")+'">'+r.replace("/link ","")+"</a>",server:server,html:!0,time:getTimeAndDate(),css:s,rank:n,PFPURL:t});else if(0==r.indexOf("/img ")){a.push().set({username:e,message:'<img src="'+r.replace("/img ","")+'" alt="'+r.replace("/img ","")+'" style="width: 100px;" align="top" />',server:server,html:!0,time:getTimeAndDate(),css:s,rank:n,PFPURL:t})}else if(0!=r.indexOf("/html ")||"admin"!=n&&"owner"!=n)if(0!=r.indexOf("/messageCSS ")||"vip"!=n&&"admin"!=n&&"owner"!=n)if(0==r.indexOf("/inviteUser "))userExists(r.replace("/inviteUser ",""))&&firebase.database().ref().child("servers").child(server).child("users").child(r.replace("/inviteUser ","")).set("");else if(0!=r.indexOf("/inviteAll")||"mod"!=n&&"admin"!=n&&"owner"!=n)if(0==r.indexOf("/createServer ")){var i={users:{},messages:{}};i.users[username]="";var d=!0;await firebase.database().ref().child("servers").once("value").then(e=>{for(var a in e.val())a==r.replace("/createSever ","")&&(d=!1)}),d&&firebase.database().ref().child("servers").child(r.replace("/createServer ","")).set(i)}else if(0!=r.indexOf("/rankUser ")||"mod"!=n&&"admin"!=n&&"owner"!=n)if(0==r.indexOf("/setPFP "))firebase.database().ref().child("users").child(username).child("PFPURL").set(r.replace("/setPFP ",""));else if(0!=r.indexOf("/setServerPFP ")||"vip"!=n&&"mod"!=n&&"admin"!=n&&"owner"!=n)if(0==r.indexOf("/help "))help(r.replace("/help ",""));else{a.push().set({username:e,message:r,server:server,html:!1,time:getTimeAndDate(),css:s,rank:n,PFPURL:t})}else firebase.database().ref().child("servers").child(server).child("PFPURL").set(r.replace("/setServerPFP ",""));else firebase.database().ref().child("users").child(r.replace("/rankUser ","").split(" ")[0]).child("rank").set(r.replace("/rankUser ","").split(" ")[1]);else inviteAll();else firebase.database().ref().child("users").child(username).child("messageCSS").set(r.replace("/messageCSS ",""));else{a.push().set({username:e,message:r.replace("/html ",""),server:server,html:!0,time:getTimeAndDate(),css:s,rank:n,PFPURL:t})}}function addSpacer(e){var r=renderMessage({username:"",message:"",server:server,html:!0,time:"",css:"color: var(--darkColor) !important; background-color: var(--darkColor) !important;",rank:"user",PFPURL:""},!1);r.id=e,"topSpacer"==e?document.querySelector("#messages").innerHTML=r.outerHTML:document.querySelector("#messages").innerHTML+=r.outerHTML}async function updateChat(e){myDatabase=e,await firebase.database().ref().child("servers").once("value").then(e=>{addSpacer("topSpacer");var r=document.createElement("div");for(var a in e.val()[server].messages){var s=renderMessage(e.val()[server].messages[a],!0);s&&r.appendChild(s)}document.querySelector("#messages").innerHTML+=r.innerHTML,addSpacer("bottomSpacer"),addServerUsers(e.val()[server].users),addPinnedServers(e.val())}),document.querySelector("#bottomSpacer").scrollIntoView({block:"end",behavior:"smooth"})}function checkMyDatabase(){firebase.database().ref().once("value").then(e=>{JSON.stringify(myDatabase)!=JSON.stringify(e.val())&&updateChat(e.val())})}</script>
