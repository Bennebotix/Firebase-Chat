<!DOCTYPE html><title>Chat</title><style>:root{--textColor:#FFF;--flareColor1:#00003B;--flareColor2:#E10600;--darkColor:#111;--lightColor:#222;--vipColor:#00FF41;--adminColor:#0041FF;--modColor:#ffa500;--ownerColor:#A00;--botColor:#765640}body{background-color:var(--darkColor);margin:0;padding:0;border:0;font-family:Courier New}.header{background-color:var(--lightColor);color:var(--textColor);font-size:38px;width:100%;text-align:center;padding:7px;position:fixed;top:0;left:0}#messages{margin-right:150px;margin-bottom:10px;margin-left:150px;margin-top:0}#usernames{background-color:var(--lightColor);height:100vh;width:100px;overflow-y:scroll;padding:10px;position:fixed;top:0;right:0}.message{margin:10px;width:100%;text-align:center;color:var(--textColor);word-break:break-word;padding:5px;font-size:20px;display:block}.out{text-align:right}.in{text-align:left}#sendMessageDiv{font-family:Courier New;font-size:50px;width:100%;text-align:center;background-color:var(--lightColor);color:var(--textColor);position:fixed;bottom:0;left:0}.button{background-color:var(--flareColor1);color:#fff;border-radius:10px;padding:10px;margin:1%;text-align:center;width:13%;border:none;height:50px;font-size:20px;font-family:Courier New}.inputs{background-color:var(--darkColor);font-family:Courier New;color:#fff;font-size:20px}.hidden{display:none}#modal{width:50%;height:50%;background-color:var(--lightColor);border-radius:10px;margin:0;padding:0;border:0;text-align:center;position:fixed;translate:50% 50%}#loginButton{width:40%!important}#loginDiv{margin:20px}#loginTitle{color:var(--textColor);font-size:38px}#loginMessage{color:var(--lightColor);font-size:18px}.user{width:70px;min-height:100px;background-color:var(--darkColor);font-size:12px;margin:5px;border-radius:10px;text-align:center;color:var(--textColor);word-break:break-word;border:none;font-family:Courier New;padding:5px}.pinnedServer{width:70px;min-height:100px;background-color:var(--darkColor);font-size:12px;margin:5px;border-radius:10px;text-align:center;color:var(--textColor);word-break:break-word;border:none;font-family:Courier New;padding:5px}.MD{font-size:13px}.vipRank{color:var(--vipColor)!important}.adminRank{color:var(--adminColor)!important}.modRank{color:var(--modColor)!important}.ownerRank{color:var(--ownerColor)!important}.botRank{color:var(--botColor)!important}.pfp{margin:5px;margin-bottom:-23px}#pinnedServers{background-color:var(--lightColor);height:100vh;width:100px;overflow-y:scroll;padding:10px;position:fixed;top:0;left:0}</style><div id=chat class=hidden><div class=header><span id=pinnedServerName></span>:</div><div id=messages></div><div id=sendMessageDiv><input class=inputs id=message placeholder="Send A Message!"onkeypress=checkMessageKey(e)><button class=button onclick=sendMessage()><strong>Send!</strong></button></div><div id=pinnedServers></div><div id=usernames></div></div><div id=login><div id=modal><br><strong id=loginTitle>Log In</strong><br><strong id=loginMessage>{{loginmessage}}</strong><br><div id=loginDiv><input class=inputs id=username placeholder=Username required><br><input class=inputs id=password placeholder=Password onkeypress=checkMessageKey(e) type=password><br><button class=button onclick=login() id=loginButton><strong>Go!</strong></button></div></div></div><script src=https://www.gstatic.com/firebasejs/8.10.1/firebase.js></script><script>var delay=200,checkMessageKey=e=>{"Enter"==e.code&&sendMessage()},encodeUnicode=e=>e.replace(/[\u00A0-\u9999<>\&]/g,e=>"&#"+e.charCodeAt(0)+";"),firebaseConfig={apiKey:"AIzaSyCgBnFbvZOW4dt-Fj64p_RS9_D59SZXEjY",authDomain:"advanced-firebase-chat.firebaseapp.com",databaseURL:"https://advanced-firebase-chat-default-rtdb.firebaseio.com",projectId:"advanced-firebase-chat",storageBucket:"advanced-firebase-chat.appspot.com",messagingSenderId:"108103744265",appId:"1:108103744265:web:568abc82110afa4a7c71d8",measurementId:"G-7RWXW0W1KM"};firebase.initializeApp(firebaseConfig);var server="main",username="",password="",ranks={user:{text:"User"},vip:{text:"VIP"},mod:{text:"Mod"},admin:{text:"Admin"},owner:{text:"Owner"},bot:{text:"Bot"}},myDatabase={},chatLoop=null;function sendMessage(){var e=getInput("message").value;saveMessage(username,e),getInput("message").value=""}function getInput(e){return document.querySelector("#"+e)}async function userExists(e){var r=!1;return await firebase.database().ref().child("users").once("value").then(a=>{for(var s in a.val())e==s&&(r=!0)}),r}async function login(){username=getInput("username").value,password="",kickedReason=[],userExists(username)&&await firebase.database().ref().child("users").child(username).once("value").then(e=>{password=e.val().password,kickedReason=[e.val().isKicked,e.val().kickReason?e.val().kickReason:null]}),password==getInput("password").value?kickedReason[0]?(document.querySelector("#loginMessage").innerHTML="This User Is Kicked Because: "+kickedReason[1],document.querySelector("#loginMessage").style.color="red"):(document.querySelector("#loginMessage").innerHTML="Loging In...",document.querySelector("#loginMessage").style.color="white",checkMyDatabase(),chatLoop=setInterval(checkMyDatabase,delay),document.querySelector("#login").classList.add("hidden"),document.querySelector("#chat").classList.remove("hidden"),document.querySelector("#chat").style.display="grid"):(document.querySelector("#loginMessage").innerHTML="Username Or Password Incorrect!",document.querySelector("#loginMessage").style.color="red")}function getTimeAndDate(){var e=new Date,r=e.getHours(),a=e.getMinutes();return"on "+(e.getMonth()+1)+"/"+e.getDate()+"/"+e.getFullYear().toString().replace("20","")+" at "+(r>12?r-12+":"+a+" PM":r+":"+a+" AM")}async function joinServer(e){await firebase.database().ref().child("users").child(username).once("value").then(e=>{e.val().rank?e.val().rank:"user"});var r=!1;await firebase.database().ref().child("servers").child(e).child("users").once("value").then(e=>{for(var a in e.val())a==username&&(r=!0)}),r&&(server=e),updateChat(myDatabase)}function addPinnedServers(e){var r=document.createElement("div");for(var a in e)for(var s in e[a].users)if(s==username){var n=document.createElement("button");(null==e[a].PFPURL||""==e[a].PFPURL)&&(e[a].PFPURL="https://i.ibb.co/hdn4FzD/35-A6-D2-D3-8-EBC-4-DE8-9414-72-E2-AAFAE0-BC.jpg"),n.innerHTML='<img src="'+e[a].PFPURL+'" style="width: 50px; height: 50px; border-radius: 50%; border: 3px solid #000;" alt="Server '+a+"'s PFP\"><br />"+encodeUnicode(a),n.classList.add("pinnedServer"),n.setAttribute("onclick","joinServer('"+a+"')"),a==server&&(n.style.boxShadow="0 0 10px 0px var(--flareColor2)"),r.appendChild(n)}r.innerHTML+="<br /><br /><br /><br />",document.querySelector("#pinnedServers").innerHTML=r.innerHTML,document.querySelector("#pinnedServerName").innerText=server}async function addServerUsers(e){var r=document.createElement("div");for(var a in e)await firebase.database().ref().child("users").child(a).once("value").then(e=>{if(e.exists()){var s=e.val();(null==s.PFPURL||""==s.PFPURL)&&(s.PFPURL="https://i.ibb.co/QjwbhJR/AC226-DA1-9-AB7-4-C04-A31-A-EBDD28-A9-FCFB.webp");var n=document.createElement("div");n.classList.add("user"),n.innerHTML='<img class="pfp" src="'+s.PFPURL+'" style="width: 50px; height: 50px; border-radius: 50%; border: 3px solid #000;" alt="'+s.username+"'s PFP\"><br /><br /><br />"+("user"==s.rank||"vip"==s.rank||"mod"==s.rank||"admin"==s.rank||"owner"==s.rank||"bot"==s.rank?'<strong class="'+s.rank+'Rank">['+ranks[s.rank].text+"]</strong><br />":"<strong>[User]</strong><br />")+a+"<br /><br />",a==username&&(n.style.boxShadow="0 0 10px 0px var(--flareColor2)"),r.appendChild(n)}});r.innerHTML+="<br /><br /><br /><br />",document.querySelector("#usernames").innerHTML=r.innerHTML}function help(e){firebase.database().ref().child("servers").child("help-"+e).child("users").child("Bennett").set(""),firebase.database().ref().child("servers").child("help-"+e).child("users").child(username).set(""),firebase.database().ref().child("servers").child("help-"+e).child("PFPURL").set("https://i.ibb.co/hdn4FzD/35-A6-D2-D3-8-EBC-4-DE8-9414-72-E2-AAFAE0-BC.jpg"),joinServer("help-"+e)}function inviteAll(){firebase.database().ref().child("users").once("value").then(e=>{for(var r in e.val())firebase.database().ref().child("servers").child(server).child("users").child(r).set("")})}function renderMessage(e,r){var a=document.createElement("div");return(null==e.PFPURL||""==e.PFPURL)&&(e.PFPURL="https://i.ibb.co/QjwbhJR/AC226-DA1-9-AB7-4-C04-A31-A-EBDD28-A9-FCFB.webp"),(null==e.creator||""==e.creator)&&(e.creator=!1),a.innerHTML=(r?'<img class="pfp" src="'+e.PFPURL+'" style="width: 50px; height: 50px; border-radius: 50%; border: 3px solid #000;" alt="'+e.username+"'s PFP\">":null)+(r?"user"==e.rank||"vip"==e.rank||"mod"==e.rank||"admin"==e.rank||"owner"==e.rank||"bot"==e.rank?'<strong class="'+e.rank+'Rank">['+ranks[e.rank].text+"]"+(e.creator?'&nbsp;<span style="color: var(--ownerColor) !important;">Server Creator</span>':"")+"</strong> ":"<strong>[User]"+(e.creator?'&nbsp;<span style="color: var(--ownerColor) !important;">Server Creator</span>':"")+"</strong> ":null),a.innerHTML+=e.html?(e.username==username?"You":e.username)+":<br /><br />"+e.message:(e.username==username?"You":e.username)+":<br /><br />"+encodeUnicode(e.message),a.innerHTML+='<br><span class="MD">'+e.time+"</span>","all"==server&&(a.innerHTML+='<br><span class="MD">'+e.server+"</span>"),a.classList.add("message"),a.style=e.css,a.classList.add(e.username==username?"out":"in"),a}async function saveMessage(e,r){var a=firebase.database().ref().child("servers").child(server).child("messages"),s="";await firebase.database().ref().child("users").child(username).once("value").then(e=>{s=e.val().messageCSS?e.val().messageCSS:""});var n="";await firebase.database().ref().child("users").child(username).once("value").then(e=>{n=e.val().rank?e.val().rank:"user"});var t="";await firebase.database().ref().child("servers").child(server).child("creator").once("value").then(e=>{t=e.val()?e.val():"Bennett"});var i="";if(await firebase.database().ref().child("users").child(username).once("value").then(e=>{i=e.val().PFPURL?e.val().PFPURL:""}),0==r.indexOf("/link "))a.push().set({username:e,message:'<a href="'+r.replace("/link ","")+'">'+r.replace("/link ","")+"</a>",html:!0,time:getTimeAndDate(),css:s,rank:n,PFPURL:i,creator:t==username});else if(0==r.indexOf("/img ")){a.push().set({username:e,message:'<img src="'+r.replace("/img ","")+'" alt="'+r.replace("/img ","")+'" style="width: 100px;" align="top" />',html:!0,time:getTimeAndDate(),css:s,rank:n,PFPURL:i,creator:t==username})}else if(0!=r.indexOf("/html ")||"admin"!=n&&"owner"!=n)if(0!=r.indexOf("/messageCSS ")||"vip"!=n&&"mod"!=n&&"admin"!=n&&"owner"!=n)if(0!=r.indexOf("/kickUser ")||"admin"!=n&&"owner"!=n)if(0!=r.indexOf("/showMessageBreaks ")||"vip"!=n&&"mod"!=n&&"admin"!=n&&"owner"!=n)if(0!=r.indexOf("/inviteUser ")||t!=username&&"admin"!=n&&"owner"!=n)if(0!=r.indexOf("/deleteServer ")||t!=username&&"admin"!=n&&"owner"!=n)if(0!=r.indexOf("/inviteAll")||"mod"!=n&&"admin"!=n&&"owner"!=n)if(0==r.indexOf("/createServer ")){var l={users:{},messages:{}};l.users[username]="";var d=!0;await firebase.database().ref().child("servers").once("value").then(e=>{for(var a in e.val())a==r.replace("/createSever ","")&&(d=!1)}),d&&firebase.database().ref().child("servers").child(r.replace("/createServer ","")).set(l)}else if(0!=r.indexOf("/createUser ")||"admin"!=n&&"owner"!=n)if(0!=r.indexOf("/rankUser ")||"admin"!=n&&"owner"!=n)if(0==r.indexOf("/setPFP "))firebase.database().ref().child("users").child(username).child("PFPURL").set(r.replace("/setPFP ",""));else if(0!=r.indexOf("/setServerPFP ")||"vip"!=n&&"mod"!=n&&"admin"!=n&&"owner"!=n)if(0==r.indexOf("/help "))help(r.replace("/help ",""));else{a.push().set({username:e,message:r,html:!1,time:getTimeAndDate(),css:s,rank:n,PFPURL:i,creator:t==username})}else firebase.database().ref().child("servers").child(server).child("PFPURL").set(r.replace("/setServerPFP ",""));else firebase.database().ref().child("users").child(r.replace("/rankUser ","").split(" ")[0]).child("rank").set(r.replace("/rankUser ","").split(" ")[1]);else{var c=r.replace("/createUser ","").split(" "),o={isKicked:!1,messageCSS:"",password:c[1],rank:c[2]};await firebase.database().ref().child("users").once("value").then(e=>{for(var r in e.val())r==c[0]&&(d=!1)}),firebase.database().ref().child("users").child(c[0]).set(o)}else inviteAll();else firebase.database().ref().child("servers").child(server).set(null);else userExists(r.replace("/inviteUser ",""))&&firebase.database().ref().child("servers").child(server).child("users").child(r.replace("/inviteUser ","")).set("");else firebase.database().ref().child("users").child(username).child("showMessageBreaks").set(r.replace("/showMessageBreaks ",""));else firebase.database().ref().child("users").child(r.replace("/kickUser ","").split(" ")[0]).child("isKicked").set(!0),firebase.database().ref().child("users").child(username).child("kickReason").set(r.replace("/kickUser "+r.replace("/kickUser ","").split(" ")[0],""));else firebase.database().ref().child("users").child(username).child("messageCSS").set(r.replace("/messageCSS ",""));else{a.push().set({username:e,message:r.replace("/html ",""),html:!0,time:getTimeAndDate(),css:s,rank:n,PFPURL:i,creator:t==username})}}function addSpacer(e){var r=renderMessage({username:"",message:"",server:server,html:!0,time:"",css:"color: var(--darkColor) !important; background-color: var(--darkColor) !important;",rank:"",PFPURL:"",creator:!1},!1);r.id=e,"topSpacer"==e?document.querySelector("#messages").innerHTML=r.outerHTML:document.querySelector("#messages").innerHTML+=r.outerHTML}async function updateChat(e){myDatabase=e,showMessageBreaks=!1,await firebase.database().ref().child("users").child(username).child("showMessageBreaks").once("value").then(e=>{e.exists()&&(showMessageBreaks=e.val())}),await firebase.database().ref().child("servers").once("value").then(e=>{addSpacer("topSpacer");var r=document.createElement("div");for(var a in e.val()[server].messages){r.appendChild(renderMessage(e.val()[server].messages[a],!0));var s=document.createElement("hr");s.style="width: 100%; border: 1px solid var(--textColor); background-color: var(--textColor);",showMessageBreaks&&r.appendChild(s)}document.querySelector("#messages").innerHTML+=r.innerHTML,addSpacer("bottomSpacer"),addServerUsers(e.val()[server].users),addPinnedServers(e.val())}),document.querySelector("#bottomSpacer").scrollIntoView({block:"end",behavior:"smooth"})}function checkMyDatabase(){firebase.database().ref().once("value").then(e=>{JSON.stringify(myDatabase)!=JSON.stringify(e.val())&&updateChat(e.val())})}</script>
